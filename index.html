<!DOCTYPE html><html lang="ja"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Â§ß‰∫∫„ÅÆÂç†„ÅÑÂ†¥ÔΩúÂç†„ÅÑ„É°„Éã„É•„ÉºÔºãË®∫Êñ≠</title>
<style>
  body { background: radial-gradient(circle at top, #3a1c71, #1a1a1a); color:#fff; font-family: 'Segoe UI', sans-serif; }
  header.site { padding:20px; background:linear-gradient(90deg,#ff512f,#dd2476); font-size:1.8em; text-align:center; font-weight:bold; letter-spacing:2px; text-shadow:0 2px 4px rgba(0,0,0,.4); }
  .wrap { max-width:960px; margin:auto; padding:20px; }
  .grid { display:grid; gap:14px; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); margin-bottom:30px; }
  a.card { display:flex; gap:12px; align-items:center; background:rgba(43,43,43,0.9); color:#fff; text-decoration:none; padding:14px; border-radius:12px; border:2px solid transparent; transition:.2s; box-shadow:0 4px 12px rgba(0,0,0,.3); }
  a.card:hover { background:rgba(60,60,60,0.95); border-color:#ff66cc; transform:scale(1.05); }
  .icon { font-size:26px; }
  section { background:rgba(43,43,43,0.95); margin-top:20px; padding:20px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,.4); }
  .back { display:inline-block; margin-bottom:10px; color:#ccc; text-decoration:none; }
  .question { margin:12px 0; }
  .result-box { background:rgba(31,31,31,0.9); border:2px solid #ff66cc; padding:15px; border-radius:8px; margin-top:15px; font-size:1.1em; box-shadow:0 0 15px rgba(255,102,204,0.5); }
  button { background:#ff66cc; color:#fff; border:none; padding:10px 18px; border-radius:6px; font-size:1em; cursor:pointer; transition:.2s; }
  button:hover { background:#ff4cb8; }
  #nicknameForm { text-align:center; padding:20px; }
  #nicknameInput { padding:8px; border-radius:4px; border:none; font-size:1em; }
</style>
</head>
<body>
  <header class="site">Â§ß‰∫∫„ÅÆÂç†„ÅÑÂ†¥</header>

  <div id="nicknameForm">
    <p>„Éã„ÉÉ„ÇØ„Éç„Éº„É†„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:</p>
    <input id="nicknameInput" type="text" placeholder="‰æã: „Çø„É≠„Ç¶">
    <button onclick="saveNickname()">ÈñãÂßã</button>
  </div>

  <div class="wrap" style="display:none;" id="menuWrap">
    <div class="grid" id="menu"></div>
  </div>

  <div id="sections"></div>

<script>
let nickname = '';
function saveNickname(){
  const input = document.getElementById('nicknameInput');
  if(!input.value.trim()){
    alert('„Éã„ÉÉ„ÇØ„Éç„Éº„É†„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
    return;
  }
  nickname = input.value.trim();
  document.getElementById('nicknameForm').style.display = 'none';
  document.getElementById('menuWrap').style.display = 'block';
  fetch('https://script.google.com/macros/s/AKfycbw8rjolXXOWcv8ymBYbx_m0vhAECApKiCc3SCAHY31zAvxSr_NF5CbuVZYd03NTtCG_Og/exec', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({type:'nickname', nickname})
  }).catch(err=>console.error(err));
}

const sectionComments = {
  perv: {max:'üî• Â§âÊÖãÂ∫¶MAXÔºÅ„ÅÇ„Å™„Åü„ÅØÈôêÁïåÁ™ÅÁ†¥„ÅÆÂ§âÊÖãÔºÅ', high:'üòâ „Å™„Åã„Å™„Åã„ÅÆÂ§âÊÖã„Å£„Å∑„Çä„Åß„Åô„ÄÇ', mid:'üôÇ Â∞ë„Åó„Å†„ÅëÂ§âÊÖãË¶ÅÁ¥†„ÅÇ„Çä„ÄÇ', low:'üòá „Å®„Å¶„ÇÇÂÅ•ÂÖ®„Å™ÂøÉ„ÅÆÊåÅ„Å°‰∏ª„ÄÇ'}
};

const questions = {
  perv: [
    {q:'‰∏Ä‰∫∫„Åß„Åô„ÇãÈ†ªÂ∫¶„ÅØÔºü', opts:['ÊØéÊó•','ÈÄ±1„Äú2','Êúà1','„Åª„Åº„Åó„Å™„ÅÑ']},
    {q:'Â•Ω„Åç„Å™‰Ωì‰Ωç„ÅØÔºü', opts:['Ê≠£Â∏∏‰Ωç','ÂæåËÉå‰Ωç','È®é‰πó‰Ωç','Áâπ„Å´„Å™„ÅÑ']},
    {q:'„Ç®„ÉÉ„ÉÅ„Å™ÂãïÁîª„ÇíË¶ã„ÇãÈ†ªÂ∫¶„ÅØÔºü', opts:['ÊØéÊó•','ÈÄ±1„Äú2','Êúà1','„Åª„ÅºË¶ã„Å™„ÅÑ']},
    {q:'Â¶ÑÊÉ≥„Åô„ÇãÈ†ªÂ∫¶„ÅØÔºü', opts:['ÊØéÊó•','ÈÄ±1„Äú2','Êúà1','„Åª„Åº„Åó„Å™„ÅÑ']},
    {q:'ÊÄßÁöÑ„Å™„Åä„ÇÇ„Å°„ÇÉ„ÇíÊåÅ„Å£„Å¶„ÅÑ„ÇãÔºü', opts:['Ë§áÊï∞ÊåÅ„Å£„Å¶„ÅÑ„Çã','1„Å§ÊåÅ„Å£„Å¶„ÅÑ„Çã','ËààÂë≥„ÅÇ„Çã„ÅåÊåÅ„Å£„Å¶„Å™„ÅÑ','ÂÖ®„ÅèÊåÅ„Å£„Å¶„Å™„ÅÑ']}
  ]
};

const sections = [
  {id:'perv',title:'Â§âÊÖãÂ∫¶„ÉÅ„Çß„ÉÉ„ÇØ',icon:'ü§Ø'},
  {id:'general',title:'Á∑èÂêàÈÅã',icon:'üîÆ'},
  {id:'love',title:'ÊÅãÊÑõÈÅã',icon:'‚ù§Ô∏è'},
  {id:'money',title:'ÈáëÈÅã',icon:'üí∞'},
  {id:'health',title:'ÂÅ•Â∫∑ÈÅã',icon:'üí™'}
];

const menuDiv = document.getElementById('menu');
const sectionsDiv = document.getElementById('sections');

sections.forEach(section=>{
  const link = document.createElement('a');
  link.className='card';
  link.href='#'+section.id;
  link.innerHTML = `<div class="icon">${section.icon}</div><div>${section.title}</div>`;
  menuDiv.appendChild(link);

  const secEl = document.createElement('section');
  secEl.id = section.id;
  secEl.innerHTML = `<a href="#" class="back">‚Üê „É°„Éã„É•„Éº„Å´Êàª„Çã</a><h2>${section.icon} ${section.title}</h2>`;
  if(questions[section.id]){
    const form = document.createElement('form');
    const qs = questions[section.id];
    qs.forEach((item,i)=>{
      const div = document.createElement('div');
      div.className = 'question';
      div.innerHTML = `Q${i+1}: ${item.q}<br>` + item.opts.map((opt,idx)=>`<label><input type="radio" name="q${i+1}" value="${item.opts.length-1-idx}">${opt}</label>`).join('<br>');
      form.appendChild(div);
    });
    form.innerHTML += '<button type="submit">Ë®∫Êñ≠„Åô„Çã</button>';
    const result = document.createElement('div');
    result.className = 'result-box';
    form.addEventListener('submit', e=>{
      e.preventDefault();
      const data = new FormData(form);
      let score=0;
      for (const val of data.values()) score += Number(val);
      const c = sectionComments[section.id];
      let comment='';
      if (score=== (qs.length * (qs[0].opts.length-1))) comment=c.max;
      else if (score>= (qs.length * (qs[0].opts.length-1) * 0.7)) comment=c.high;
      else if (score>= (qs.length * (qs[0].opts.length-1) * 0.4)) comment=c.mid;
      else comment=c.low;
      result.innerHTML = `<p><strong>${nickname} „Åï„Çì„ÅÆ„Çπ„Ç≥„Ç¢:</strong> ${score} / ${qs.length * (qs[0].opts.length-1)}</p><p>${comment}</p>`;
      fetch('https://script.google.com/macros/s/AKfycbw8rjolXXOWcv8ymBYbx_m0vhAECApKiCc3SCAHY31zAvxSr_NF5CbuVZYd03NTtCG_Og/exec', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({type:'result', nickname, section:section.id, score})
      }).catch(err=>console.error(err));
    });
    secEl.appendChild(form);
    secEl.appendChild(result);
  }
  sectionsDiv.appendChild(secEl);
});
</script>
</body></html>
